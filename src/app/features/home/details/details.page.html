<mat-toolbar *transloco="let t">
  <button
    routerLink=".."
    routerDirection="back"
    mat-mini-fab
    class="capture-rebranded-button"
  >
    <mat-icon svgIcon="capture-rebrand-arrow-left"></mat-icon>
  </button>
  <div class="toolbar-spacer"></div>
  <ng-container *ngrxLet="activeDetailedCapture$ as activeDetailedCapture">
    <button
      *ngIf="activeDetailedCapture.id"
      (click)="openShareMenu()"
      mat-mini-fab
      class="capture-rebranded-button"
    >
      <mat-icon svgIcon="capture-rebrand-share"></mat-icon>
    </button>
  </ng-container>
  <button mat-mini-fab class="capture-rebranded-button">
    <mat-icon svgIcon="capture-rebrand-support"></mat-icon>
  </button>
  <button
    *ngIf="(isFromSeriesPage$ | ngrxPush) === false"
    (click)="openOptionsMenu()"
    mat-mini-fab
    class="capture-rebranded-button"
    joyrideStep="highlightDetailsPageOptionsMenu"
    [title]="t('userGuide.optionsMenu')"
    [text]="t('userGuide.clickTheOptionsMenuToUseNetworkActions')"
  >
    <mat-icon svgIcon="capture-rebrand-more-horiz"></mat-icon>
  </button>
</mat-toolbar>

<div class="content" *ngrxLet="detailedCaptures$ as detailedCaptures">
  <swiper
    *ngrxLet="initialSlideIndex$ as initialSlideIndex"
    [virtual]="true"
    [initialSlide]="initialSlideIndex"
    [resistanceRatio]="0"
    [observeSlideChildren]="true"
    [resizeObserver]="true"
    [observeParents]="true"
    (swiper)="onSwiperCreated($event)"
    (slideChange)="onSlidesChanged()"
    class="swiper"
  >
    <ng-template
      swiperSlide
      *ngFor="
        let detailedCapture of detailedCaptures;
        trackBy: trackDetailedCapture
      "
    >
      <div class="slide">
        <app-media-rebranded
          [src]="detailedCapture.mediaUrl$ | ngrxPush"
          [mimeType]="detailedCapture.mediaMimeType$ | ngrxPush"
          [routerLink]="[
            '/media-viewer',
            detailedCapture.mediaUrl$ | ngrxPush,
            { mimeType: detailedCapture.mediaMimeType$ | ngrxPush }
          ]"
        >
        </app-media-rebranded>
        <div class="vertical-space-24"></div>
        <ion-list lines="none">
          <ion-item>
            <ion-avatar slot="start">
              <!-- TODO: use profile image -->
              <img src="https://bit.ly/3zc8aMk" />
            </ion-avatar>
            <ion-label>
              <div>
                {{ detailedCapture.creator$ | ngrxPush }}
              </div>
              <div class="property-value">Member since Aug 2022</div>
            </ion-label>
          </ion-item>
        </ion-list>
        <div class="vertical-space-36"></div>
        <mat-accordion>
          <mat-expansion-panel
            hideToggle
            [expanded]="expanded"
            (opened)="openPanel()"
            (closed)="closePanel()"
          >
            <mat-expansion-panel-header
              collapsedHeight="auto"
              expandedHeight="auto"
            >
              <mat-panel-title>
                <div class="asset-info">
                  <span class="asset-info-key">Location:</span>
                  {{ detailedCapture.locationDisplay$ | ngrxPush }}
                </div>
                <div class="asset-info">
                  <span class="asset-info-key">Date:</span>
                  {{
                    (detailedCapture.timestamp$
                      | ngrxPush
                      | date: 'mediumDate') || ('notDisclosed' | transloco)
                  }}
                </div>
                <div class="asset-info">
                  <span class="asset-info-key">ID:</span>
                  {{ detailedCapture.id }}
                </div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="panel-content">
              <div class="asset-info">
                <span class="asset-info-key">{{ 'hash' | transloco }}:</span>
                {{ detailedCapture.hash }}
              </div>
              <div class="asset-info">
                <span class="asset-info-key">
                  {{ 'mimeType' | transloco }}:
                </span>
                {{ detailedCapture.mediaMimeType$ | ngrxPush }}
              </div>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
        <div class="show-more-button" (click)="togglePanel()">
          {{ expanded ? 'Show less' : 'Show more...' }}
        </div>
        <div class="text-center">
          <ion-button routerLink="information">
            {{ 'moreInformation' | transloco }}
          </ion-button>
        </div>
      </div>
    </ng-template>
  </swiper>
</div>

<ion-footer>
  <div class="custom-footer-content">
    <div class="price">
      <!-- TODO: Ask senior devs how price is calculated -->
      <div class="currency">Price (ETH)</div>
      <div class="amount">0.725</div>
    </div>

    <button (click)="mintNft()" mat-flat-button color="primary">
      {{ 'collect' | uppercase }}
    </button>
  </div>
</ion-footer>
