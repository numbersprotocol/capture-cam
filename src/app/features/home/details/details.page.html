<mat-toolbar *transloco="let t">
  <app-capture-back-button></app-capture-back-button>
  <div class="toolbar-spacer"></div>
  <ng-container *ngrxLet="activeDetailedCapture$ as activeDetailedCapture">
    <button
      *ngIf="activeDetailedCapture.id"
      (click)="openShareMenu()"
      mat-mini-fab
      class="capture-rebranded-button"
    >
      <mat-icon svgIcon="capture-rebrand-share"></mat-icon>
    </button>
  </ng-container>
  <button
    *ngIf="(isFromSeriesPage$ | ngrxPush) === false"
    (click)="openOptionsMenuWithAvailableOptions()"
    mat-mini-fab
    class="capture-rebranded-button"
    joyrideStep="highlightDetailsPageOptionsMenu"
    [title]="t('userGuide.optionsMenu')"
    [text]="t('userGuide.clickTheOptionsMenuToUseNetworkActions')"
  >
    <mat-icon svgIcon="capture-rebrand-more-horiz"></mat-icon>
  </button>
</mat-toolbar>

<div class="content" *ngrxLet="detailedCaptures$ as detailedCaptures">
  <swiper-container
    #swiper
    *ngrxLet="initialSlideIndex$ as initialSlideIndex"
    [attr.initial-slide]="initialSlideIndex"
    resistance-ratio="0"
    observe-slide-children="true"
    resize-observer="true"
    observe-parents="true"
    class="swiper"
  >
    <swiper-slide
      *ngFor="
        let detailedCapture of detailedCaptures;
        let i = index;
        trackBy: trackDetailedCapture
      "
    >
      <div class="slide">
        <!-- Show capture details with Ionic when capture is not uploaded or the network is disconnected -->
        <app-capture-details-with-ionic
          *ngIf="(showCaptureDetailsInIframe$ | ngrxPush) === false"
          [detailedCapture]="detailedCapture"
        ></app-capture-details-with-ionic>

        <!-- Show capture details with an iframe only for active slide (and adjacent slides for smoother swiping) -->
        <app-capture-details-with-iframe
          *ngIf="
            (showCaptureDetailsInIframe$ | ngrxPush) === true &&
            isSlideNearActive(i)
          "
          [detailedCapture]="detailedCapture"
          [slideIsActive]="activeSlideIndex === i"
        ></app-capture-details-with-iframe>
      </div>
    </swiper-slide>
  </swiper-container>
</div>
