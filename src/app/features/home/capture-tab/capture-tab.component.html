<div
  *ngIf="(capturesByDate$ | async) === null"
  class="loading-spinner-container"
>
  <ion-spinner></ion-spinner>
</div>
<mat-card *transloco="let t" class="user-card">
  <mat-card-header>
    <div
      (click)="uploadAvatar()"
      *ngIf="!hasAvatar"
      mat-card-avatar
      class="user"
    >
      <mat-icon class="user-icon">add_a_photo</mat-icon>
    </div>
    <div
      (click)="uploadAvatar()"
      *ngIf="hasAvatar"
      mat-card-avatar
      class="user"
    >
      <img
        mat-card-avatar
        class="user-img"
        src="https://material.angular.io/assets/img/examples/shiba1.jpg"
        alt="Photo of a Shiba Inu"
      />
    </div>

    <mat-card-title
      >{{ username$ | async }}
      <button mat-button (click)="editUsername()">
        <mat-icon class="edit-icon">edit</mat-icon>
      </button>
    </mat-card-title>
    <mat-card-subtitle>{{ email$ | async }} </mat-card-subtitle>
  </mat-card-header>
</mat-card>
<hr />
<div class="capture-container">
  <ng-container
    *ngFor="
      let group of capturesByDate$ | async | keyvalue: keyDescendingOrder;
      trackBy: trackCaptureGroupByDate
    "
  >
    <div class="mat-title">{{ group.key }}</div>
    <mat-grid-list cols="3" gutterSize="8px">
      <mat-grid-tile
        *ngFor="let captureItem of group.value; trackBy: trackCaptureItem"
        [routerLink]="
          captureItem.isCollecting
            ? undefined
            : ['capture-details', { oldProofHash: captureItem.oldProofHash }]
        "
        class="capture-item"
      >
        <div
          *ngIf="captureItem.isCollecting"
          class="collecting-spinner-container"
        >
          <ion-spinner></ion-spinner>
        </div>
        <ion-icon
          *ngIf="captureItem.isCollecting"
          name="hourglass-outline"
          class="collecting"
        ></ion-icon>
        <ion-icon
          *ngIf="captureItem.proof.diaBackendAssetId"
          src="/assets/icon/media-id.svg"
          class="uploaded"
        >
        </ion-icon>
        <ion-icon
          *ngIf="captureItem.hasGeolocation"
          src="/assets/icon/location.svg"
          class="located"
        ></ion-icon>
        <img [src]="captureItem.thumbnailUrl" />
      </mat-grid-tile>
    </mat-grid-list>
  </ng-container>
</div>
